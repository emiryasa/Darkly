Feedback formunda yaptığımız testte, Name alanına a, Message alanına ise (<svg/onload=alert('XSS')>a) şeklinde bir payload gönderildi. Bu giriş sayfada filtrelenmeden/kaçışlanmadan geri yansıtıldı ve tarayıcı SVG içindeki onload olayını çalıştırdığı için payload kullanıcı tarafında tetiklendi — yani kullanıcı girdisi HTML/SVG olarak işlendi ve JavaScript yürütüldü (reflected XSS). Bu davranış sayesinde sayfanın tarayıcıda render edildiği bağlamda gizli/veri içeren çıktının ortaya çıkmasına izin verildi ve test sırasında hedef çıktıya (flag) erişildi. Özetle; kullanıcı girdisi sunucuda güvenli hale getirilmeden veya bağlama uygun şekilde kaçışlanmadan doğrudan sayfa içine yerleştirildiği için XSS çalıştı.

Çözüm:

Girdi doğrulama ve bağlama uygun çıktı kaçışlama (output encoding): Sunucuya gelen tüm kullanıcı girdilerini kabul etmeden önce doğrulayın; ancak doğrulama tek başına yeterli değildir — kullanıcı girdileri HTML çıktısına yerleştirilirken bağlama (HTML metin, HTML öznitelik, JavaScript, URL, CSS vs.) uygun kaçışlama uygulanmalı. Örneğin HTML içine yazılan veriler &, <, > gibi karakterler uygun HTML kaçışına (HTML entity encoding) tabi tutulmalı; veriyi DOM'a eklerken innerHTML kullanmak yerine textContent/benzer güvenli yöntemler tercih edilmeli.
HTML/SVG girişlerini beyaz listeyle temizleme (sanitization): Eğer kullanıcıların zengin içerik (HTML) göndermesine izin varsa, güvenilir bir kütüphane (ör. DOMPurify benzeri) ile sadece izin verilen tag ve atributları beyaz listeye alıp geri kalanları temizleyin. SVG ve on* olay atributları, <script> gibi tehlikeli öğeler ve inline event handler'lar varsayılan olarak engellenmelidir.
İçerik Güvenlik Politikası (CSP): Sunucuya uygun, katı bir CSP header’ı ekleyin (ör. Content-Security-Policy) — özellikle script-src ile yalnızca güvenilir kaynaklara izin verin ve mümkünse 'unsafe-inline' kullanımını kaldırın. CSP, tek başına kusursuz olmasa da inline script/event handler’ların etkisini büyük ölçüde azaltır.
Template motoru ve framework güvenlik özellikleri: Sunucuda kullanılan template motorunun otomatik kaçışlama özelliklerini devre dışı bırakmayın; ayrıca kullanıcı verisini HTML’e ekleyen kod yollarını gözden geçirip innerHTML/raw render kullanımını azaltın.
Güvenlik başlıkları ve çerez ayarları: X-Content-Type-Options: nosniff, Referrer-Policy, X-Frame-Options gibi başlıkları ekleyin; oturum çerezlerini HttpOnly, Secure ve uygun SameSite ile gönderin—bu, XSS ile çerez çalınmasını zorlaştırır.
Sunucu tarafı kayıt, rate-limit ve hücre koruması: Kullanıcı girdilerini kaydederken (log) hassas verileri maskalayın, şüpheli girdiler ve tekrar eden istekler için rate limiting uygulayın ve WAF/IPS ile bilinen payload kalıplarını engellemeyi düşünün.
Güvenlik testi ve eğitim: Düzenli olarak otomatik ve manuel XSS testleri (kod incelemesi, pentest) yapın; geliştiricileri bağlama uygun kaçışlama, sanitization ve güvenli DOM yazımı konusunda eğitin.